---
layout: post
cid: 33
title: Go使用JSON序列化出现首字母大小写问题
slug: 33
date: 2021/06/24 00:47:00
updated: 2021/06/24 00:48:28
status: publish
author: sunday
categories: 
  - GOLANG
tags: 
customSummary: 
mathjax: auto
noThumbInfoStyle: default
outdatedNotice: no
reprint: standard
thumb: 
thumbChoice: default
thumbDesc: 
thumbSmall: 
thumbStyle: default
---

来看看吧 <!--more--> 

Go语言通过首字母的大小写来控制访问权限。无论是方法，变量，常量或是自定义的变量类型，如果首字母大写，则可以被外部包访问，反之则不可以。

而结构体中的字段名，如果首字母小写的话，则该字段无法被外部包访问和解析，比如，json解析。

    package main
    
    import (
    	"encoding/json"
    	"fmt"
    )
    
    type Person struct {
    	Name string
    	Age  int
    	Sex string
    	hobby []string
    }
    
    func main()  {
    
    	person := Person{"小白菜-姚",20,"男",[]string{"吸烟","喝酒","烫头发"}}
    
    	// 对于上结构体进行序列化
    	bytes,err := json.Marshal(person)
    	if err != nil {
    		fmt.Println("无法进行序列化,err:",err)
    		return
    	}
    		fmt.Println(string(bytes))
    }

输出结果为：

    {"Name":"小白菜-姚","Age":20,"Sex":"男"}

可以看到，上述结果我们丢失了hobby切片中的数据.

如果希望json化之后的属性名是小写字母，可以在定义结构体时使用struct tag。如下：

    type Person struct {
    	Name string
    	Age  int
    	Sex string
    	Hobby []string `json:"hobby"`
    }

结果：

    {"Name":"小白菜-姚","Age":20,"Sex":"男","hobby":["吸烟","喝酒","烫头发"]}

最后，如果没有特别的访问控制的话，建议字段名首字母都使用大写字母，从而避免无法解析的错误。
